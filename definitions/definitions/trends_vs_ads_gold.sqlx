config {
  type: "table",
  schema: "gold",
  tags: ["trends", "ads"]
}

SELECT
  fa.start_date AS date,
  fa.search_term,
  gt.interest AS search_interest
FROM
  ${ref("facebook_ads_clean")} AS fa
LEFT JOIN
  ${ref("google_trends_clean")} AS gt
ON
  fa.start_date = gt.date
  AND LOWER(fa.search_term) = gt.search_term
WHERE
  fa.search_term IS NOT NULL
